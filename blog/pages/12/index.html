<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Developing on Staxmanade - Developing on Staxmanade</title>
  <meta name="author" content="Jason Jarrett">


   <meta name="description" content="Jason Jarrett&#x27;s Blog and Website.">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <link rel="canonical" href="http://staxmanade.com">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.feedburner.com/DevelopingOnStaxmande" rel="alternate" title="Developing on Staxmanade" type="application/atom+xml">
    <script src="/js/modernizr-2.0.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./js/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/octopress.js" type="text/javascript"></script>
    <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1017448-6']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>

</head>

<body   >
<header role="banner"><hgroup>
  <h1><a href="/">Developing on Staxmanade</a></h1>
</hgroup>

</header>
<nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/DevelopingOnStaxmande" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
</ul>
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:staxmanade.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
<div id="main">
    <div id="content">
        
<div class="blog-index">
    <article>
        <header>
    <h1 class="entry-title"><a href="http://staxmanade.com/2010/01/networking-brain-fart/">Networking Brain Fart.</a></h1>
    <p class="meta">
          <time datetime="2010-01-22T01:59:00.000Z" pubdate data-updated="true">Jan 21st 2010</time>


        
    </p>
</header>
<div class="entry-content">
<div class='post'>
<p>This one was just too funny to not write down. The epitome of a <a href="http://en.wikipedia.org/wiki/Brain_fart">Brain Fart</a>.</p>  <p>There sure seem to be quote a few posts lately talking about the Software (Crafts-Man/Woman/person/whatever); I may have many many more years of Craft practicum to study up on before I can truly consider myself a Craftsman. However, it’s humbling to screw up and remember that we are human. Below is one such story. Luckily there was no software, business value, or puppies hurt in the process.</p>  <h4>Setup:</h4>  <p>I work from home part time. Where I usually just remote desktop into my 64bit, quad-core, 12 gig of ram, supercomputer desktop at work. (I’m sure I’ll read this post in the future and go what? supercomputer? you have no idea young man.) I choose the RDP network latency over not being able to compile (in under XXX_too_much_time_XXX) on my laptop at home. (It’s part time one day a week and not worth the investment to beef up the home setup. -- yet) <strong>Point is: I’m working from home and via remote desktop on my computer at the office</strong>.</p>  <p>So I’m working on this project and…let’s just say I somehow got into a position where I thought my best option was to take my solution offline from TFS. (long story I don’t want to overshadow the “Brain Fart” part of this post)</p>  <p>This is where I got into trouble…</p>  <h4>How do I take my solution offline from TFS?</h4>  <p>I searched for how to take my solution offline and found this great post “<a href="http://ozgrant.com/2008/06/01/force-visual-studio-to-think-tfs-is-offline/">Force Visual Studio to think TFS is offline</a>” which outlines several options…</p>  <blockquote>   <p>Option 1 – Use the ‘tfpt tweakui’ utility</p>    <p>Option 2 – Yank the network cable before starting Visual Studio</p>    <p>Option 3 – Set a registry key</p> </blockquote>  <p><strong>Option 1:</strong> I didn’t think I had TFS Power Tools installed (turns out I did, just didn’t spend the 2 seconds to figure it out - doh).</p>  <p><strong>Option 3</strong>: I couldn’t seem to get the registry key version to work (for some reason???) &amp; wasn’t interested in wasting the day to figure it out.</p>  <p><strong>--- So what was left?</strong></p>  <p><strong>Option 2</strong>: “Yank the network cable before starting Visual Studio”. I didn’t yank the cord because clearly I’m not at the office so how could I do that????, but tried the next best thing. <strong>I disabled my network connection </strong>(so I could open the solution and have it NOT find TFS)<strong>.</strong></p>  <p><img style="display: block; float: none; margin-left: auto; margin-right: auto" src="http://i223.photobucket.com/albums/dd272/Solblade44/You%20Fail/fail-i-told-you.jpg" /></p>  <p>If you missed the detail earlier in the post – I said that I was working through <a href="http://en.wikipedia.org/wiki/Remote_Desktop_Protocol">RDP</a>. </p>  <p>Huh - Not anymore… Sigh!</p>  <p>Some days it may just be safer to work from home (disconnected from the world).</p>  <p>&#160;</p>  <h5>P.S. thanks to a co-worker for getting me back online :)</h5>  </div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Jason.Jarrett</div>
<div class='content'>
I know there is (supposed to be this button) but for some reason whenever I&#39;m on a machine with Visual Studio &amp; TFS It&#39;s never there... :)</div>
</div>
<div class='comment'>
<div class='author'>justinmchase</div>
<div class='content'>
What&#39;s even worse is that there&#39;s a little button on the top of the Solution Explorer when you have a project that&#39;s associated with TFS and you just click it ;)</div>
</div>
<div class='comment'>
<div class='author'>Obsidience</div>
<div class='content'>
if you&#39;re gonna do it, do it right.  next time give me a call and I&#39;ll yank the cable for real :-P</div>
</div>
</div>
</div>

      
    </article>
    <article>
        <header>
    <h1 class="entry-title"><a href="http://staxmanade.com/2010/01/unitymoq-automocker-or/">Unity/Moq - AutoMocker or AutoMockingContainer</a></h1>
    <p class="meta">
          <time datetime="2010-01-03T16:53:00.000Z" pubdate data-updated="true">Jan 3rd 2010</time>


        
    </p>
</header>
<div class="entry-content"><h4>What is an Auto Mocking Container?</h4>
<p>This post started to get a little long, so I won't re-explain the concept.</p>
<p><a href="http://lostechies.com/joshuaflanagan/">Joshua Flanagan</a> wrote a nice overview at his <a href="http://www.lostechies.com/">Los Techies</a> blog: <a href="http://www.lostechies.com/blogs/joshuaflanagan/archive/2009/02/03/auto-mocking-explained.aspx">Auto mocking Explained</a>.</p>
<p>My post is mainly here to describe the Unity version of an automocking container I threw together.</p>
<h4>In Jan 2009 I blogged about my initial version of the Unity AutoMocker - Why am I blogging about it again?</h4>
<p>I originally wrote the AutoMocker for the Unity container a year ago (Jan 2009, in Silverlight), and finally got around to placing the code up in the <a href="http://code.google.com/p/moq-contrib/">moq-contrib</a> project in June of 2009.</p>
<p>I'm writing another post today in hopes to:</p>
<ol>
<li>Get some feedback on how this little snippet of code should continue.</li>
<li>Give a little more how-to/example code</li>
<li>Describe some updates I made since I originally created it.</li>
</ol>
<h4>Where can I get it?</h4>
<p>This is one part where I'd appreciate some feedback.</p>
<p>I have two slightly different versions out there (currently).</p>
<p>I have one version at the <a href="http://code.google.com/p/elegantcode/source/browse/#svn/trunk/Coders/JasonJarrett/UnityAutoMocker">ElegantCode</a> repository where I was working on it, and the other I threw up at <a href="http://code.google.com/p/moq-contrib/">moq-contrib</a>.</p>
<p>The core of the UnityAutoMockContainer is the same in both places, it's how the tests are separated out that differ.</p>
<p>In the <a href="http://code.google.com/p/elegantcode/source/browse/#svn/trunk/Coders/JasonJarrett/UnityAutoMocker">ElegantCode repository</a> it's an all in one self contained single file (that you can copy into your own test project(s)). You can then setup a single test in your own testing framework that runs all internal automocker tests (in case you need to modify it yourself, and don't want to break any existing functionality). EX: test</p>
<pre><code class="language-C#">    <span class="hljs-list">[<span class="hljs-keyword">Test</span>]
    public void Should_run_all_UnityAutoMockContainer_internal_tests<span class="hljs-list">()</span>
    {
        Moq.AutoMocking.SelfTesting.UnityAutoMockContainerFixture.RunAllTests<span class="hljs-list">(<span class="hljs-keyword">Console.WriteLine</span>)</span><span class="hljs-comment">;</span>
    }
</span></code></pre>
<p>I kind of like this format as it makes it easy to port between test libraries. Can't say I like having the tests in the same file as the core, but it certainly is not a large chunk of code (so far) so it's relatively small to maintain and definitely easier to manage as a single .cs file than another assembly (which would have to be version dependent on both Unity and Moq).</p>
<p>The <a href="http://code.google.com/p/moq-contrib/">moq-contrib</a> is definitely where I think this helper should end up (and it is there). I just happened to break the tests out into the Silverlight test project and the core is alone in a file.</p>
<p>It's current state isn't as easy to copy to a test library (Silverlight/Desktop/Unity 1.2/Unity 2.0) as the one at <a href="http://elegantcode.com/">ElegantCode</a>. What does anyone think? Should I put them all together in one file?</p>
<p>However it ends up (1. all in one file or two (1 test) (1 core)) it will continue to be maintained on the <a href="http://code.google.com/p/moq-contrib/">moq-contrib</a> project.</p>
<h4>What is the high level API of the container?</h4>
<p>It's pretty simple, (currently) there are four methods on the container.</p>
<p>Two for registering items with the container. Say you want to register an already created instance, or say you want to map an interface to a concrete class and <em>not</em> have the container generate mocks automatically for special cases.</p>
<p>And two for pulling items out of the container. Whether you want a instance of T or a Mock<T>, it gives you ways to retrieve both.</p>
<blockquote>
<p><img src="http://lh5.ggpht.com/_L6Vw0x_R3iw/S0DLkezvL7I/AAAAAAAAANQ/3CZqGQAh-fA/image_thumb1.png?imgmax=800" alt="image" title="image"></p>
</blockquote>
<h4>How can I setup my own registrations with the container?</h4>
<p>Say I don't want to have the container generate mocks for specific items and I want to supply specific configuration to the UnityContainer.</p>
<pre><code class="language-C#"> <span class="hljs-keyword">public</span> UnityAutoMockContainer RegisterInstance&lt;TService&gt;(TService instance)

 <span class="hljs-keyword">public</span> UnityAutoMockContainer <span class="hljs-keyword">Register</span>&lt;TService, TImplementation&gt;() 
     <span class="hljs-keyword">where</span> TImplementation : TService
</code></pre>
<p>Note: both of these registration methods return the container itself so you can fluently stack registration. EX:</p>
<pre><code class="language-C#">    AutoMockContainer
        .Register<span class="hljs-tag">&lt;<span class="hljs-title">IServiceA,</span> <span class="hljs-attribute">ServiceA</span>&gt;</span>()
        .Register<span class="hljs-tag">&lt;<span class="hljs-title">IServiceB,</span> <span class="hljs-attribute">ServiceB</span>&gt;</span>();
</code></pre>
<p>Let me know: I haven't tested or played around with how this automocking container deals with any container specific xml configuration… So although I don't think you should probably have that in a test assembly (stuff happens). Let me know if there are any issues.</p>
<h4>How do I get items out of the container?</h4>
<p>First is the Resolve<T>(). It will pull an item T out of the container. (Creating it if not already existing)</p>
<p><code>public T Resolve&lt;T&gt;()</code></p>
<p>When T is an interface Resolve<T> (unless you setup registration specifically with the container) should return basically <code>(new Mock()).Object</code></p>
<p>When T is a concrete Class, the container should return an instance of T and any of it's dependencies will be satisfied by mocks. (Note that T will not be any sort of mocked instance of T, unless you used the GetMock as described below first)</p>
<p><code>public Mock GetMock() where T : class</code></p>
<p>When T is an interface GetMock should return basically <code>(new Mock())</code></p>
<p>When T is a concrete Class, the container should return a new Mock() and any of it's dependencies will be satisfied by mocks.</p>
<h4>How do I use the UnityAutoMockContainer?</h4>
<p>It's pretty basic, you first create an instance of the UnityAutoMockContainer, and from there you can ask it for mocks of an (Interface, Class, or Abstract Class).</p>
<p>If you request an instance of a concrete class, or abstract class, the UnityAutoMockContainer will stuff mocks in for any constructor dependencies of your concrete class (if it can). You can then request from the container those same dependencies one at a time and either apply mocking setups or verifications.</p>
<blockquote>
<p>NOTE: Anything the container creates will live as a singleton instance in the container. So any other requests from the container will always return the originally created instance. Therefore, each distinct scenario in a test suite should have their own instances of the container.</p>
</blockquote>
<p>Below his an example of how you can leverage the container in some tests. Given this base fixture class…</p>
<pre><code class="language-C#"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FixtureBase</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> UnityAutoMockContainer _autoMockContainer = <span class="hljs-keyword">new</span> UnityAutoMockContainer();

    <span class="hljs-keyword">protected</span> UnityAutoMockContainer AutoMockContainer
    {
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> _autoMockContainer; }
    }

    [TestFixtureSetUp]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetupContext_ALL</span><span class="hljs-params">()</span>
    </span>{
        Before_all_tests();
        Because();
    }

    [TestFixtureTearDown]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">TearDownContext_ALL</span><span class="hljs-params">()</span>
    </span>{
        After_all_tests();
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Before_all_tests</span><span class="hljs-params">()</span>
    </span>{
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Because</span><span class="hljs-params">()</span>
    </span>{
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">After_all_tests</span><span class="hljs-params">()</span>
    </span>{
    }
}
</code></pre>
<p>If I were given the following system to test.</p>
<pre><code class="language-C#"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IServiceA</span> { <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RunA</span><span class="hljs-params">()</span></span>; }
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IServiceB</span> { <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RunB</span><span class="hljs-params">()</span></span>; }

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">TestComponent</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TestComponent</span><span class="hljs-params">(IServiceA serviceA, IServiceB serviceB)</span>
    </span>{
        ServiceA = serviceA;
        ServiceB = serviceB;
    }

    <span class="hljs-keyword">public</span> IServiceA ServiceA { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">private</span> <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> IServiceB ServiceB { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">private</span> <span class="hljs-keyword">set</span>; }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RunAll</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">if</span> (!HowDidItGo())
            <span class="hljs-keyword">return</span>;
        ServiceA.RunA();
        ServiceB.RunB();
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">HowDidItGo</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-comment">// some really nasty untestable code</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
    }
}
</code></pre>
<p>The below example demonstrates simply verifying some behavior on the mocked dependencies of the system under test.</p>
<pre><code class="language-C#"><span class="hljs-list">[<span class="hljs-keyword">TestFixture</span>]
public class Example__how_to_pull_items_from_the_UnityAutoMockContainer_when_verifying_behavior_after_an_action_was_taken 
    : FixtureBase
{
    private TestComponent _testComponent<span class="hljs-comment">;</span>

    protected override void Before_all_tests<span class="hljs-list">()</span>
    {
        base.Before_all_tests<span class="hljs-list">()</span><span class="hljs-comment">;</span>
        _testComponent = AutoMockContainer.Resolve&lt;TestComponent&gt;<span class="hljs-list">()</span><span class="hljs-comment">;</span>
    }

    protected override void Because<span class="hljs-list">()</span>
    {
        _testComponent.RunAll<span class="hljs-list">()</span><span class="hljs-comment">;</span>
    }

    <span class="hljs-list">[<span class="hljs-keyword">Test</span>]
    public void Should_run_ServiceA_RunA<span class="hljs-list">()</span>
    {
        AutoMockContainer
            .GetMock&lt;IServiceA&gt;<span class="hljs-list">()</span>
            .Verify<span class="hljs-list">(<span class="hljs-keyword">v</span> =&gt; v.RunA<span class="hljs-list">()</span>, Times.Once<span class="hljs-list">()</span>)</span><span class="hljs-comment">;</span>
    }

    <span class="hljs-list">[<span class="hljs-keyword">Test</span>]
    public void Should_run_ServiceB_RunB<span class="hljs-list">()</span>
    {
        AutoMockContainer
            .GetMock&lt;IServiceB&gt;<span class="hljs-list">()</span>
            .Verify<span class="hljs-list">(<span class="hljs-keyword">v</span> =&gt; v.RunB<span class="hljs-list">()</span>, Times.Once<span class="hljs-list">()</span>)</span><span class="hljs-comment">;</span>
    }
}
</span></span></span></code></pre>
<p>Next, you may have noticed that the system under test had a complicated internal method (that may not necessarily be testable). You can use the AutoMocker to create the system under test as a Mock itself, so we can override some of the behavior. Here's how you could quickly do that.</p>
<blockquote>
<p>Aside: I'm not saying this is a good practice or aids in good component design, just saying it's possible</p>
</blockquote>
<pre><code class="language-C#"><span class="hljs-list">[<span class="hljs-keyword">TestFixture</span>]
public class Example__how_to_use_the_UnityAutoMockContainer_to_override_a_method_on_the_SystemUnderTest_to_test_a_certain_behavior
    : FixtureBase
{

    private TestComponent _testComponent<span class="hljs-comment">;</span>

    protected override void Before_all_tests<span class="hljs-list">()</span>
    {
        base.Before_all_tests<span class="hljs-list">()</span><span class="hljs-comment">;</span>
        var mockTestComponent = AutoMockContainer.GetMock&lt;TestComponent&gt;<span class="hljs-list">()</span><span class="hljs-comment">;</span>

        mockTestComponent
            .Setup<span class="hljs-list">(<span class="hljs-keyword">s</span> =&gt; s.HowDidItGo<span class="hljs-list">()</span>)</span>
            .Returns<span class="hljs-list">(<span class="hljs-keyword">false</span>)</span><span class="hljs-comment">;</span>

        _testComponent = mockTestComponent.Object<span class="hljs-comment">;</span>
    }

    protected override void Because<span class="hljs-list">()</span>
    {
        _testComponent.RunAll<span class="hljs-list">()</span><span class="hljs-comment">;</span>
    }

    <span class="hljs-list">[<span class="hljs-keyword">Test</span>]
    public void Should_run_ServiceA_RunA<span class="hljs-list">()</span>
    {
        AutoMockContainer
            .GetMock&lt;IServiceA&gt;<span class="hljs-list">()</span>
            .Verify<span class="hljs-list">(<span class="hljs-keyword">v</span> =&gt; v.RunA<span class="hljs-list">()</span>, Times.Never<span class="hljs-list">()</span>)</span><span class="hljs-comment">;</span>
    }

    <span class="hljs-list">[<span class="hljs-keyword">Test</span>]
    public void Should_run_ServiceB_RunB<span class="hljs-list">()</span>
    {
        AutoMockContainer
            .GetMock&lt;IServiceB&gt;<span class="hljs-list">()</span>
            .Verify<span class="hljs-list">(<span class="hljs-keyword">v</span> =&gt; v.RunB<span class="hljs-list">()</span>, Times.Never<span class="hljs-list">()</span>)</span><span class="hljs-comment">;</span>
    }
}
</span></span></span></code></pre>
<p>It's amazing how much redundant test setup code this little helper has saved me in my tests. I hope others can find some use with this as well.</p>
</div>

      
    </article>
    <article>
        <header>
    <h1 class="entry-title"><a href="http://staxmanade.com/2009/12/powershell-load-assembly-without/">Powershell: Load assembly without locking file.</a></h1>
    <p class="meta">
          <time datetime="2009-12-23T05:40:00.000Z" pubdate data-updated="true">Dec 22nd 2009</time>


        
    </p>
</header>
<div class="entry-content">
<div class='post'>
<p>This post had some updates based on comments so I’m just updating the one over at <a href="http://elegantcode.com/">ElegantCode</a>.</p>  <p><a href="http://elegantcode.com/2009/12/22/powershell-load-assembly-without-locking-file/">http://elegantcode.com/2009/12/22/powershell-load-assembly-without-locking-file/</a></p>  </div>
</div>

      
    </article>
    <article>
        <header>
    <h1 class="entry-title"><a href="http://staxmanade.com/2009/12/statlight-goes-open-source/">StatLight – Goes Open Source</a></h1>
    <p class="meta">
          <time datetime="2009-12-11T03:27:00.000Z" pubdate data-updated="true">Dec 10th 2009</time>


        
    </p>
</header>
<div class="entry-content">
<div class='post'>
<p>Although I made a very minor attempt at making <a href="http://statlight.net" target="_blank">StatLight</a> a “for-sale” product, I knew when I started that open-source was most likely going to be my long term path for <a href="http://statlight.net" target="_blank">StatLight</a>.</p>  <h5>What is it? (Silverlight Testing Automation Tool)</h5>  <p>StatLight is a tool developed for automating the setup, running, and gathering results of Silverlight unit tests. StatLight helps to speed up the feedback cycles while practicing<a href="http://en.wikipedia.org/wiki/Test-driven_development"> TDD</a>/<a href="http://en.wikipedia.org/wiki/Behavior_Driven_Development">BDD</a>/(insert your test style here) during Silverlight development.</p>  <h5>Where can I get StatLight?</h5>  <p><a href="http://StatLight.CodePlex.com">http://StatLight.CodePlex.com</a></p>  <p>&#160;</p>  <h4>Happy Coding !!!</h4>  </div>
</div>

      
    </article>
    <article>
        <header>
    <h1 class="entry-title"><a href="http://staxmanade.com/2009/12/go-to-definition-tip-with-c-var-keyword/">Go to Definition Tip with the C# ‘var’ keyword</a></h1>
    <p class="meta">
          <time datetime="2009-12-02T06:09:00.000Z" pubdate data-updated="true">Dec 1st 2009</time>


        
    </p>
</header>
<div class="entry-content">
<div class='post'>
<p>This may be totally obvious to the masses out there, and it isn’t much of a tip, other than to say <strong>it works</strong>…</p>  <p></p>  <h5>Did You Know?</h5>  <p><strong>F12 (Go To Definition) – works on the C# </strong><a href="http://msdn.microsoft.com/en-us/library/bb383973.aspx"><strong><u>var</u></strong></a> keyword<strong></strong>?</p>  <p>(That’s all there is to this post – the rest is just rambling)</p>  <p>I hit it on accident the other day (yes I know, <strong>F12</strong> isn’t exactly in the usual path of accidental keystrokes, trust me it was on accident). It brought Visual Studio to a screeching halt. That is, while VS was trying to load the <a href="http://msdn.microsoft.com/en-us/library/exy1facf(VS.80).aspx">object browser</a>, and satellites were linking up in outer space trying get some message sent through the <a href="http://en.wikipedia.org/wiki/Pony_Express">Pony Express</a> about a <a href="http://www.urbandictionary.com/define.php?term=tweetup&amp;defid=3639937">tweetup</a> with the <a href="http://weblogs.asp.net/scottgu/archive/2009/10/29/add-reference-dialog-improvements-vs-2010-and-net-4-0-series.aspx">Add Reference Dialog</a>. (Point being – loading the object browser is REALLY SLOW)</p>  <p>It dawned on me that the <strong>F12</strong> (Go To Definition) keyboard shortcut works on the <a href="http://msdn.microsoft.com/en-us/library/bb383973.aspx">var</a> keyword.</p>  <p>Usually I just use the tool tip window when I don’t have time to decipher why the variable’s naming isn’t clear. (<a href="http://devlicio.us/blogs/hadi_hariri/archive/2009/11/20/var-improves-readability.aspx?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed:+Devlicious+(Devlicio.us)&amp;utm_content=Google+Reader">good post on the subject</a>)</p>  <p><a href="http://lh3.ggpht.com/_L6Vw0x_R3iw/SxYEpdzTPPI/AAAAAAAAAM4/V5DBhnTm7O4/s1600-h/image3.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/_L6Vw0x_R3iw/SxYEpxUBU2I/AAAAAAAAAM8/QMYR-Veivq8/image_thumb1.png?imgmax=800" width="247" height="67" /></a>&#160;</p>  <p>FYI: for those R# fans, who noticed after installing it, you lost the code metadata window in C# when F12ing it (Go To Definition). They’ve fixed it in the upcoming version <a href="http://www.jetbrains.net/jira/browse/RSRP-35547">http://www.jetbrains.net/jira/browse/RSRP-35547</a>. So my satellites/pony express/tweetup/add ref dialog comment above won’t be an issue anymore. <strong>Yippee!</strong></p>  </div>
</div>

      
    </article>
    <article>
        <header>
    <h1 class="entry-title"><a href="http://staxmanade.com/2009/11/pdc-2009-talking-about-win7-user/">PDC 2009 – (Talking about Win7 User Experience)</a></h1>
    <p class="meta">
          <time datetime="2009-11-24T06:27:00.000Z" pubdate data-updated="true">Nov 23rd 2009</time>


        
    </p>
</header>
<div class="entry-content">
<div class='post'>
<p>As a #NotAtPDC attendee following along from the outside I just had to post this little bit of irony…</p>  <p>While watching one of the PDC 2009 keynotes live they were talking about how great Windows 7 user experience is.</p>  <p>“so we’re going to show you a demo of how “… bla bla great bla…”our user experience has improved”… And the video cuts to this - <strong>here’s my user experience</strong>.</p>  <p><a href="http://lh3.ggpht.com/_L6Vw0x_R3iw/Swt83NRzVBI/AAAAAAAAAMw/VIPamcFhC8w/s1600-h/image3.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/_L6Vw0x_R3iw/Swt832vvF3I/AAAAAAAAAM0/_eNo0gDawWs/image_thumb1.png?imgmax=800" width="669" height="412" /></a> </p>  <p>and we come back to the show (crowds laughing in the background)</p>  <p>I don’t know what he said after rejoining the stream as I started writing this post… </p>  <p>and right after we cut to this.</p>  <p><a href="http://lh3.ggpht.com/_L6Vw0x_R3iw/Swt83NRzVBI/AAAAAAAAAMw/VIPamcFhC8w/s1600-h/image3.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/_L6Vw0x_R3iw/Swt832vvF3I/AAAAAAAAAM0/_eNo0gDawWs/image_thumb1.png?imgmax=800" width="649" height="392" /></a> </p>  <p>And then we came back with commentary saying “it’s great to see the reaction”. Don’t know what is so secret they couldn’t broadcast online (but can show thousands in the live audience).</p>  <p>I just thought it was ironic, how much emphasis went into a great user experience blah blah, and the image above is all it was for us :)</p>  <p>Oh well (maybe it’s in the PDC keynote you can watch on line now), or maybe, I’m just jealous I didn’t one of the <a href="http://www.betanews.com/joewilcox/article/Microsoft-gives-free-laptops-to-PDC-2009-attendees/1258566424">netbooks</a>.</p>  </div>
</div>

      
    </article>
    <article>
        <header>
    <h1 class="entry-title"><a href="http://staxmanade.com/2009/11/enum-conversion-why-oh-why/">Enum conversion. Why Oh Why?</a></h1>
    <p class="meta">
          <time datetime="2009-11-15T07:02:00.000Z" pubdate data-updated="true">Nov 14th 2009</time>


        
    </p>
</header>
<div class="entry-content">
<div class='post'>
<p><a href="http://lh5.ggpht.com/_L6Vw0x_R3iw/Sv-ngaEoLWI/AAAAAAAAAMg/EXgQWVuuS18/s1600-h/image4.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/_L6Vw0x_R3iw/Sv-ngh5lO_I/AAAAAAAAAMk/6Mlo3qg3Ysw/image_thumb1.png?imgmax=800" width="569" height="364" /></a>&#160;</p>  <p>What MSDN says: <a href="http://msdn.microsoft.com/en-us/library/sbbt4032.aspx">enum (C# Reference)</a></p>  <p><a href="http://lh3.ggpht.com/_L6Vw0x_R3iw/Sv-ng8eAR3I/AAAAAAAAAMo/LlX88s7OQvc/s1600-h/image3.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/_L6Vw0x_R3iw/Sv-nhJELZZI/AAAAAAAAAMs/nhAjJrMikiM/image_thumb11.png?imgmax=800" width="572" height="134" /></a></p>  <p>Why can’t this just work?</p>  </div>
</div>

      
    </article>
    <article>
        <header>
    <h1 class="entry-title"><a href="http://staxmanade.com/2009/11/massive-search-replace-among-files/">Massive Search &amp; Replace Among Files Checked-in to TFS</a></h1>
    <p class="meta">
          <time datetime="2009-11-07T21:03:00.000Z" pubdate data-updated="true">Nov 7th 2009</time>


        
    </p>
</header>
<div class="entry-content"><p>This post is a note to myself, as the two outlined below contain code/commands I've done (wished I could have done automatically in the past) that I want to save for reference later.</p>
<p>I spent the last (almost full year) taking baby steps in an effort to make our logic layer a tiny smidgen eency weency bit more testable. Trust me, trying to replace an everything's a Singleton architecture is no easy task. I won't go into my strong dislike for Singletons – take a look at <a href="http://tinyurl.com/yl8bnhj">Singletons are Evil</a>. I've slowly worn the team down into an agreement that we will not propagate any more Singletons in the project.  They've given me a new saying &quot;Read my lips. NO NEW SINGLETONS!&quot;.</p>
<h5>PowerShell assisted regular expression search and replace.</h5>
<p>In my case, the specific regular expression needed to find</p>
<pre><code>    SomeBusinessLogicClass.Instance.SomeFooMethod(bar);
</code></pre>
<p>and replace it with</p>
<pre><code>    Resolve<span class="hljs-comment">()</span>.SomeFooMethod<span class="hljs-comment">(bar)</span>;
</code></pre>
<p>Below is the PowerShell script I used.</p>
<pre><code class="language-PowerShell"><span class="hljs-comment"># define the find and replacement regular expressions.</span>
<span class="hljs-variable">$regex_find</span> = <span class="hljs-string">'([a-zA-Z]+)\\.Instance\\.'</span>
<span class="hljs-variable">$regex_replace</span> = <span class="hljs-string">'Resolve().'</span>

<span class="hljs-comment"># get all the C# files we want to search/replace through</span>
<span class="hljs-variable">$allFiles</span> = <span class="hljs-built_in">Get-ChildItem</span> -Filter *.cs -Recurse

<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$fileToReplace</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$allFiles</span>)
{
    <span class="hljs-variable">$fileString</span> = <span class="hljs-variable">$fileToReplace</span>.FullName
    <span class="hljs-keyword">if</span>([String]::Join([Environment]::NewLine, (<span class="hljs-built_in">Get-Content</span> -Path <span class="hljs-variable">$fileString</span>)) <span class="hljs-operator">-match</span> <span class="hljs-variable">$regex_find</span>)
    {
        <span class="hljs-comment"># make the file writable so we can update it</span>
        <span class="hljs-variable">$fileToReplace</span>.IsReadOnly = <span class="hljs-variable">$false</span>;
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"applying fix to - <span class="hljs-variable">$fileString</span>"</span>

        <span class="hljs-comment"># here's where we load up the file iterate through each line   </span>
        <span class="hljs-comment"># replace any of the regex matches</span>
        <span class="hljs-comment"># and save the file back to the original location</span>
        <span class="hljs-built_in">Set-Content</span> <span class="hljs-variable">$fileString</span> -Value ((<span class="hljs-built_in">Get-Content</span> -Path <span class="hljs-variable">$fileString</span>) | <span class="hljs-keyword">foreach</span> { <span class="hljs-keyword">if</span>( <span class="hljs-variable">$_</span> <span class="hljs-operator">-match</span> <span class="hljs-variable">$regex_find</span>) { <span class="hljs-variable">$_</span> <span class="hljs-operator">-replace</span> <span class="hljs-variable">$regex_find</span>, <span class="hljs-variable">$regex_replace</span> } <span class="hljs-keyword">else</span> { <span class="hljs-variable">$_</span> } } )
    }
}
</code></pre>
<blockquote>
<p>Caveat:</p>
<ul>
<li>Some of the files &quot;end of file&quot; changed (added an extra end line in some cases)</li>
</ul>
</blockquote>
<h5>Team Foundation Server tip to detect the changed files.</h5>
<p>The next step requires you install the <a href="http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx">TFS Power Tools</a>. Once installed, fire up the PowerShell console given in the start menu</p>
<p><img src="http://lh4.ggpht.com/_L6Vw0x_R3iw/SvXgh4v7zpI/AAAAAAAAAMc/nqAF3xb87Xk/image_thumb1.png?imgmax=800" alt="image" title="image"></p>
<p>I then ran the following command to have all edited files automatically detected as modified and can then be set as pending a change in TFS.</p>
<blockquote>
<p>tfpt online /adds /diff /recursive .</p>
</blockquote>
</div>

      
    </article>
    <article>
        <header>
    <h1 class="entry-title"><a href="http://staxmanade.com/2009/10/integration-test-brought-to-you-by/">Integration Test Brought to you by Powershell &amp; NUnit – with a Little Specification Syntax for Flavoring</a></h1>
    <p class="meta">
          <time datetime="2009-10-26T05:02:00.000Z" pubdate data-updated="true">Oct 25th 2009</time>


        
    </p>
</header>
<div class="entry-content">
<div class='post'>
<p>One of the tools I’ve used the last half of a year and really enjoyed is the C# specification extension methods when writing unit test assertions. If you’re looking for a little more background on the topic, I wrote about <a href="/2009/02/fluent-specification-extensions">Fluent Specification Extensions</a> in a past blog.</p>  <p>Recently I wanted to execute a PowerShell script to do some automated <a href="http://en.wikipedia.org/wiki/Functional_testing">functional testing</a>. I wanted to execute an application and apply some assertions on the output of the software(basically running a console app, parse the xml output and assert on values in the output).</p>  <blockquote>   <p>FYI: I’m very new to PowerShell, so any suggestions on how I implemented the below are welcome…</p> </blockquote>  <p>I’ve seen a couple examples of writing test assertions in PowerShell out there. One example is <a href="http://www.psunit.org/">PSUnit</a>; however, this seemed a little heavy for my needs and not quite the syntactic sugar I was looking for.</p>  <p>Besides the syntax flavor I was desiring, another thing I wanted to do was leverage the power of NUnit.Framework’s assertion capabilities. I like the error messages generated when strings and other objects fail the assertion.</p>  <h5>Examples of end result ShouldLookLike()… </h5>  <p>$true.ShouldBeTrue()    <br />$false.ShouldBeFalse()     <br />&quot;a&quot;.ShouldEqual(&quot;a&quot;)     <br />&quot;a&quot;.ShouldNotEqual(&quot;b&quot;)     <br /></p>  <h5><strong>Step 1</strong>: Figure out how to write a C# style <a href="http://msdn.microsoft.com/en-us/library/bb383977.aspx">extension method</a> in PowerShell.</h5>  <blockquote>   <p>I found a great blog post describing how to extend any PowerShell object to add extension methods. </p>    <p><a href="http://bartdesmet.net/blogs/bart/archive/2007/09/06/extension-methods-in-windows-powershell.aspx">Extension Methods in Windows PowerShell</a>       <br />      <br /></p> </blockquote>  <p>In short, to extend types in PowerShell leveraging the <a href="http://msdn.microsoft.com/en-us/library/ms714419(VS.85).aspx">Extended Type System</a>, you need to define them in an xml file and import the method definitions into the PowerShell runtime instance.</p>  <p>Below is PowerShell XML definition for my NUnit Specification Extensions.</p>  <pre class="brush: xml;">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;<br />&lt;Types&gt;<br />    &lt;Type&gt;<br />        &lt;Name&gt;System.Object&lt;/Name&gt;<br />        &lt;Members&gt;<br />            &lt;ScriptMethod&gt;<br />                &lt;Name&gt;ShouldBeFalse&lt;/Name&gt;<br />                &lt;Script&gt;<br />                    [NUnit.Framework.Assert]::IsFalse($this)<br />                &lt;/Script&gt;<br />            &lt;/ScriptMethod&gt;<br />            &lt;ScriptMethod&gt;<br />                &lt;Name&gt;ShouldBeTrue&lt;/Name&gt;<br />                &lt;Script&gt;<br />                    [NUnit.Framework.Assert]::IsTrue($this)<br />                &lt;/Script&gt;<br />            &lt;/ScriptMethod&gt;<br />            &lt;ScriptMethod&gt;<br />                &lt;Name&gt;ShouldEqual&lt;/Name&gt;<br />                &lt;Script&gt;<br />                    [NUnit.Framework.Assert]::AreEqual($args[0], $this)<br />                &lt;/Script&gt;<br />            &lt;/ScriptMethod&gt;<br />            &lt;ScriptMethod&gt;<br />                &lt;Name&gt;ShouldNotEqual&lt;/Name&gt;<br />                &lt;Script&gt;<br />                    [NUnit.Framework.Assert]::AreNotEqual($args[0], $this)<br />                &lt;/Script&gt;<br />            &lt;/ScriptMethod&gt;<br />        &lt;/Members&gt;<br />    &lt;/Type&gt;<br />&lt;/Types&gt;</pre><br /><br /><h4>&#160;</h4><br /><br /><p>Take the above XML and save it to a file…</p><br /><br /><blockquote><br />  <p>NOTE: the file HAS to be saved with the extension <strong>.ps1xml</strong></p><br /><br />  <p>Ex: NunitSpecificationPowerShellExtensions<strong>.ps1xml</strong></p><br /></blockquote><br /><br /><h4>&#160;</h4><br /><br /><h5>Step 2: Load the extended type definition into the PowerShell runtime.</h5><br /><br /><p>Once you’ve saved the XML extended types to a file, you need to load it into the PowerShell runtime by executing the command below.</p><br /><br /><blockquote><br />  <p><br />    <br />Update-TypeData -PrependPath NunitSpecificationPowerShellExtensions.ps1xml <br /><br />    <br /><br /><br />    <br /></p><br /></blockquote><br /><br /><p><br />  <br />Before executing the above statement…Let’s quickly look at a System.String’s members and properties – just to show you what the extension methods look like when applied inside of the runtime.<a href="http://lh5.ggpht.com/_L6Vw0x_R3iw/SuUtUHyzTHI/AAAAAAAAAMI/RYyswVWg2JQ/s1600-h/image%5B3%5D.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/_L6Vw0x_R3iw/SuUtVnUMsEI/AAAAAAAAAMM/KiZ3QVj1yQA/image_thumb%5B1%5D.png?imgmax=800" width="586" height="479" /></a></p><br /><br /><p>After executing the Update-TypeData command you’ll notice there are a number of “ScriptMethod” MemberTypes added to the object.</p><br /><br /><p><a href="http://lh3.ggpht.com/_L6Vw0x_R3iw/SuUtXQNAz2I/AAAAAAAAAMQ/5tqoE9oUG6I/s1600-h/image%5B19%5D.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/_L6Vw0x_R3iw/SuUtY0t9T1I/AAAAAAAAAMU/6lwJgXtWaUU/image_thumb%5B9%5D.png?imgmax=800" width="600" height="580" /></a> </p><br /><br /><p></p><br /><br /><p>Now if you try to execute one of those newly added extension methods, you may get the following error…</p><br /><br /><p>PS C:\&gt; $testVar.<strong>ShouldEqual</strong>(&quot;hello world&quot;) <br /><br />  <br />Exception calling &quot;ShouldEqual&quot; with &quot;1&quot; argument(s): &quot;<strong>Unable to find type [NUnit.Framework.Assert]: make sure that the <br />    <br />assembly containing this type is loaded.</strong>&quot; <br /><br />  <br />At line:1 char:21 <br /><br />  <br />+ $testVar.ShouldEqual &lt;&lt;&lt;&lt; (&quot;hello world&quot;) <br /><br />  <br />&#160;&#160;&#160; + CategoryInfo&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : NotSpecified: (:) [], MethodInvocationException <br /><br />  <br />&#160;&#160;&#160; + FullyQualifiedErrorId : ScriptMethodRuntimeException</p><br /><br /><p></p><br /><br /><p>&#160;</p><br /><br /><p>This is because we need to load the NUnit.Framework assembly into the runtime before we can leverage the extension methods.</p><br /><br /><blockquote><br />  <p>[System.Reflection.Assembly]::LoadFrom(&quot;C:\Program Files\NUnit 2.5.2\bin\net-2.0\framework\nunit.framework.dll&quot;) | Out-Null</p><br /></blockquote><br /><br /><p>&#160;</p><br /><br /><p>Now that the extension methods have been defined and loaded into the runtime, NUnit.Framework is loaded, we can now use the methods on any object that inherits from System.Object (which, as far as I know, is everything in PowerShell).</p><br /><br /><p>&#160;</p><br /><br /><p>And now, everything you need in one script (if you have the xml extended type file saved somewhere…)</p><br /><br /><pre># <br /># Update-TypeData -prependPath C:\Code\NunitSpecificationPowerShellExtensions.ps1xml<br />#<br /><br />[System.Reflection.Assembly]::LoadFrom(&quot;C:\Program Files\NUnit 2.5.2\bin\net-2.0\framework\nunit.framework.dll&quot;) | Out-Null<br /><br />$true.ShouldBeTrue()<br /><br />$false.ShouldBeFalse()<br /><br />&quot;a&quot;.ShouldEqual(&quot;a&quot;)<br /><br />&quot;a&quot;.ShouldNotEqual(&quot;b&quot;)<br /></pre>  </div>
</div>

      
    </article>
    <article>
        <header>
    <h1 class="entry-title"><a href="http://staxmanade.com/2009/10/invited-to-join-bloggers-over-at/">Invited to join the bloggers over at ElegantCode</a></h1>
    <p class="meta">
          <time datetime="2009-10-21T13:58:00.000Z" pubdate data-updated="true">Oct 21st 2009</time>


        
    </p>
</header>
<div class="entry-content">
<div class='post'>
<p>If you follow any of the big .Net blog aggregators, (<a href="http://codebetter.com/">CodeBetter</a>, <a href="http://www.lostechies.com">LosTechies</a>, etc…) you probably already follow and saw my invitation to join the bloggers over at <a href="http://elegantcode.com/">ElegantCode</a>.</p>  <p>My current thought is to publish in both locations… We’ll see how that goes.</p>  </div>
</div>

      
    </article>
  <div class="pagination">
      <a class="prev" href="/blog/pages/13/">&larr; Older</a>
    <a href="/blog/archives">Blog Archives</a>
      <a class="next" href="/blog/pages/11/">Newer &rarr;</a>
  </div>
</div>


    </div>
</div>
<footer role="contentinfo"><p>
  Copyright &copy; 2015 - Jason Jarrett - <span class="credit">Powered by <a href="http://togglejs.github.io">Toggle</a></span>
</p>

</footer>
  



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



</body>
</html>
